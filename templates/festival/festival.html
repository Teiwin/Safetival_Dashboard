{% extends "base.html" %}
{% load static %}
{% block title %}
  {{ event_name }}
{% endblock title %}
{% block styles %}
  <link rel="stylesheet"
        href="https://unpkg.com/leaflet@1.7.1/dist/leaflet.css" />
  <link rel="stylesheet" href="{% static 'css/festival.css' %}" />
{% endblock styles %}
{% block content %}
  <div id="map"></div>
  <div id="right-menu">
    <h3>Statistics</h3>
    <p>Total participants: {{ number_of_participants }}</p>
    <button id="graphs-button" onclick="location.href=">Graphs</button>
  </div>
  <div id="left-menu">
    <h3>Heatmap</h3>
    <button id="toggle-grid">Toggle Heatmap</button>
    <div id="heatmap-settings" style="display: none">
      <h4>Settings</h4>
      <label for="radius">
        Radius: <span id="radius-value"></span>
      </label>
      <input type="range" min="1" max="50" value="25" class="slider" id="radius" />
      <label for="blur">
        Blur: <span id="blur-value"></span>
      </label>
      <input type="range" min="1" max="50" value="15" class="slider" id="blur" />
    </div>
    <h3>Time Slider</h3>
    <button id="toggle-time-slider">Toggle Time Slider</button>
    <div id="time-slider-settings" style="display: none">
      <label for="time-slider">
        Timestamp: <span id="time-slider-value"></span>
      </label>
      <input type="range"
             min="0"
             max="1000"
             value="0"
             class="slider"
             id="time-slider" />
    </div>
  </div>
{% endblock content %}
{% block scripts %}
  <script src="https://unpkg.com/leaflet@1.7.1/dist/leaflet.js"></script>
  <script src="https://cdn.jsdelivr.net/gh/Leaflet/Leaflet.heat@master/dist/leaflet-heat.js"></script>
  {% comment %} defining constants {% endcomment %}
  <script>
    const map = L.map("map").fitBounds([
      [{{ min_lat }}, {{ min_lng }}],
      [{{ max_lat }}, {{ max_lng }}]
    ]);
    const participant_positions = {{ participant_positions|safe }};
    const startTimestamp = {{start_time}}; // Replace with the actual start timestamp value
    const endTimestamp = {{end_time}}; // Replace with the actual end timestamp value
  </script>
  <script src="{% static 'js/festival.js' %}"></script>
  <script src="{% static 'js/heatmap.js' %}"></script>
{% endblock scripts %}
